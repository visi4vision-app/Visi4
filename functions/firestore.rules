rules_version = '2';
service cloud.firestore {
 match /databases/{db}/documents {

  match /wallet/{uid} {
    allow read: if request.auth.uid == uid;
    allow write: if false;
  }

  match /payments/{id} {
    allow read: if request.auth.uid == resource.data.uid;
    allow write: if false;
  }

  match /withdrawals/{id} {
    allow create: if request.auth != null;
    allow read: if request.auth.uid == resource.data.uid;
  }

  match /{doc=**} {
    allow read, write: if false;
  }
 }
}
